{"version":3,"sources":["HomeCtrl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\controller","sourcesContent":["// Copyright (C) 2019, Flickering Inc. All rights reserved.\r\n// Author: hongchangfu (hongchangfu@flickering.ai)\r\n\r\n//首界面\r\n\r\nimport HomeView from \"../view/HomeView\";\r\nimport MySound, { AudioType } from \"../MySound\";\r\nimport RootNode, { postMessageName } from \"../RootNode\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class HomeCtrl extends HomeView {\r\n    /** 切换动画是否播放中 */\r\n    private animPlaying:boolean = false;\r\n\r\n    start() {\r\n        this.addEventListener();\r\n        this.setSoundSprite();\r\n        //是否有重传分数\r\n        RootNode.instance.haveScoreRetransmission();\r\n        this.setkid();\r\n    }\r\n\r\n    /**\r\n     * 监听按钮点击\r\n     */\r\n    private addEventListener() {\r\n        //帮助\r\n        this.guideBtn.on(\"click\", () => {\r\n            MySound.instance.playAudio(AudioType.Button);\r\n            this.homeHelp.open();\r\n        });\r\n\r\n        //开始游戏\r\n        this.startBtn.on(\"click\", () => {\r\n            MySound.instance.playAudio(AudioType.Button);\r\n            RootNode.instance.loadScene(\"game\");\r\n        })\r\n\r\n        //声音开关\r\n        this.soundBtn.on(\"click\", () => {\r\n            MySound.instance.setMut();\r\n            MySound.instance.playAudio(AudioType.Button, 0.1);\r\n            this.setSoundSprite();\r\n        })\r\n\r\n        //排行榜\r\n        this.chartsBtn.on(\"click\", () => {\r\n            this.charts.open();\r\n            MySound.instance.playAudio(AudioType.Button, 0.1);\r\n        })\r\n\r\n        //数感星球\r\n        this.starBtn.on(\"click\", () => {\r\n            MySound.instance.playAudio(AudioType.Button);\r\n            RootNode.instance.jumpApp();\r\n        });\r\n\r\n        //分享\r\n        this.shareBtn.on(\"click\", () => {\r\n            MySound.instance.playAudio(AudioType.Button);\r\n            RootNode.instance.onShareBtn();\r\n        });\r\n\r\n        //切换游戏版本\r\n        this.kidbtn.on(\"click\", () => {\r\n            MySound.instance.playAudio(AudioType.Button);\r\n            if(this.animPlaying)\r\n                return;\r\n            RootNode.instance.isKid = !RootNode.instance.isKid;\r\n            this.kidAnimPlay();\r\n        });\r\n\r\n        //怪物图鉴\r\n        this.monsterBtn.on(\"click\", () => {\r\n            MySound.instance.playAudio(AudioType.Button);\r\n            let tipsAction = cc.sequence(\r\n                cc.fadeIn(0.3),\r\n                cc.delayTime(2),\r\n                cc.fadeOut(0.3),\r\n            )\r\n            this.tips.stopAllActions();\r\n            this.tips.runAction(tipsAction);\r\n        });\r\n\r\n         //公众号\r\n         this.subscriptionBtn.on(\"click\", () => {\r\n            MySound.instance.playAudio(AudioType.Button);\r\n          \r\n            this.subscriptionNode.active = true;\r\n        });\r\n\r\n        //群分享函数\r\n        RootNode.instance.showGroup = (any) => {\r\n            this.charts.groupLunch(any);\r\n        };\r\n\r\n        //是否是从群分享启动\r\n        RootNode.instance.LunchGroup();\r\n    }\r\n\r\n    /**\r\n     * 设置声音按钮图片\r\n     */\r\n    private setSoundSprite() {\r\n        if (MySound.instance.isMut)\r\n            this.soundSprite.spriteFrame = this.soundArr[1];\r\n        else\r\n            this.soundSprite.spriteFrame = this.soundArr[0];\r\n    }\r\n\r\n    /**\r\n     * 设置版本\r\n     */\r\n    private setkid() {\r\n        let animNum = RootNode.instance.isKid ? 2 : 3;\r\n        let clips = this.kidAnim.getClips();\r\n        let name = clips[animNum].name;\r\n        this.kidAnim.play(name);\r\n    }\r\n\r\n    /**\r\n     * 模式切换动画\r\n     */\r\n    private kidAnimPlay() {\r\n        let animNum = RootNode.instance.isKid ? 1 : 0;\r\n        let clips = this.kidAnim.getClips();\r\n        let name = clips[animNum].name;\r\n        let state = this.kidAnim.play(name);\r\n        let time = state.duration;\r\n        this.animPlaying = true;\r\n        let callback = () => {\r\n            this.animPlaying = false;\r\n        }\r\n        this.scheduleOnce(callback,time);\r\n    }\r\n}"]}