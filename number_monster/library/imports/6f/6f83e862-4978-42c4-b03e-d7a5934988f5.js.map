{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\view/assets\\scripts\\view\\Ball.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\view","sourcesContent":["// Copyright (C) 2019, Flickering Inc. All rights reserved.\r\n// Author: hongchangfu (hongchangfu@flickering.ai)\r\n\r\n// 球类\r\n\r\nimport { ballsize, ballScale, ColliderType, ballHighLightWidth, EyeState, ballRestitution, ballFriction, ballAngularDamping } from \"../GameConfig\";\r\n\r\nimport GameCtrl from \"../controller/GameCtrl\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Ball extends cc.Component {\r\n    @property({ type: cc.Node, visible: true, displayName: \"底\" })\r\n    private bottomNode: cc.Node = undefined;\r\n\r\n    @property({ type: cc.Node, visible: true, displayName: \"球节点\" })\r\n    public ballNode: cc.Node = undefined;\r\n\r\n    @property({ type: [cc.SpriteFrame], visible: true, displayName: \"眼睛图片\" })\r\n    public eyeSpriteFrameArr: Array<cc.SpriteFrame> = [];\r\n\r\n    @property({ type: [cc.Sprite], visible: true, displayName: \"眼睛\" })\r\n    public eyeSpriteArr: Array<cc.Sprite> = [];\r\n\r\n    /** 球的数字*/\r\n    public ballNum: number = undefined;\r\n\r\n    /** 是否为疯狂模式的5 */\r\n    public crazyBall: boolean = false;\r\n\r\n    /** 最大倾斜角度 */\r\n    private limitAngle = 15;\r\n\r\n    /** 刚体 */\r\n    private _rigid: cc.RigidBody = undefined;\r\n\r\n    /** 碰撞组件 */\r\n    private _collider: cc.PhysicsCollider = undefined;\r\n\r\n    /** 点击次数用于检测双击 */\r\n    private hold_one_click = 0;\r\n\r\n    /** 球的尺寸 */\r\n    private nodeSize: cc.Vec2 = undefined;\r\n\r\n    /**11-14 不规则碰撞组件的点*/\r\n    private colliderPoints: Array<cc.Vec2> = [];\r\n\r\n    /** 圆底部阴影 */\r\n    private shadowNode: cc.Node = undefined;\r\n\r\n    /** 是否被选中 */\r\n    private _slect = false;\r\n\r\n    /** 手指触碰点与球心的位置 */\r\n    private subPos: cc.Vec2 = undefined;\r\n\r\n    /** 移动结束位置 */\r\n    private moveEnd: cc.Vec2 = undefined;\r\n\r\n    /** 移动时移出球 */\r\n    private moveOut: boolean = false;\r\n\r\n    /** 眼睛的状态 */\r\n    private eyeState: EyeState = undefined;\r\n\r\n    /** 大于10的球的数目 */\r\n    private static bigThanTenNum: number = 0;\r\n\r\n    /** 是否被回收 */\r\n    private isResume: boolean = false;\r\n\r\n\r\n    start() {\r\n        this.addEventListener();\r\n        this.shadowNode = this.ballNode.getChildByName(\"shadow\");\r\n        this.shadowNode.opacity = 255;\r\n    }\r\n\r\n    update(dt: number) {\r\n        if (this.node.rotation > this.limitAngle)\r\n            this.node.rotation = this.limitAngle;\r\n        else if (this.rigid.node.rotation < -this.limitAngle)\r\n            this.node.rotation = -this.limitAngle;\r\n        this.move(dt);\r\n    }\r\n\r\n    /**\r\n     * 只在两个碰撞体开始接触时被调用一次\r\n     * @param contact \r\n     * @param selfCollider 自己的碰撞体\r\n     * @param otherCollider 发生碰撞的碰撞体\r\n     */\r\n    onBeginContact(contact: cc.PhysicsContact, selfCollider: cc.PhysicsCollider, otherCollider: cc.PhysicsCollider) {\r\n        if (otherCollider.tag == ColliderType.Normal)\r\n            this.judegeBlink();\r\n    }\r\n\r\n    public set ballStatic(enabled: boolean) {\r\n        if (enabled) {\r\n            this.rigid.type = cc.RigidBodyType.Static;\r\n            this.speed = cc.Vec2.ZERO;\r\n        } else {\r\n            this.rigid.type = cc.RigidBodyType.Dynamic;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 球的刚体组件\r\n     */\r\n    public get rigid() {\r\n        if (this._rigid == undefined) {\r\n            this._rigid = this.node.getComponent(cc.RigidBody);\r\n            this._rigid.angularDamping = ballAngularDamping;\r\n        }\r\n        return this._rigid;\r\n    }\r\n\r\n    /**\r\n     * 碰撞组件\r\n     */\r\n    public get collider() {\r\n        if (this._collider == undefined) {\r\n            this._collider = this.node.getComponent(cc.PhysicsCollider);\r\n            this._collider.restitution = ballRestitution;\r\n            this._collider.friction = ballFriction;\r\n        }\r\n        return this._collider;\r\n    }\r\n\r\n    /**\r\n     * 设置触发状态,底高亮\r\n     */\r\n    public set setTrigger(enabled: boolean) {\r\n        this.bottomNode.opacity = enabled ? 255 : 0;\r\n        this.shadowNode.opacity = enabled ? 0 : 255;\r\n    }\r\n\r\n    /**\r\n     * 更新手指最新位置\r\n     * @param touchPos 移动点的位置\r\n     */\r\n    public movePos(touchPos: cc.Vec2) {\r\n        let flag = cc.Intersection.pointInPolygon(touchPos, GameCtrl.instance.bottomPoints);\r\n        //是否超出可移动区域\r\n        if (flag || Math.abs(touchPos.x) > 360) {\r\n            //超出的第一个点保留,球才能移动到目标位置\r\n            if (!this.moveOut) {\r\n                this.moveEnd = touchPos;\r\n                this.moveOut = true;\r\n            }\r\n            return;\r\n        }\r\n\r\n        //未赋值和超出状态移入,重新计算值\r\n        if (this.subPos == undefined || this.moveOut) {\r\n            this.subPos = touchPos.sub(this.node.position);\r\n            if (this.judgePosOut(this.subPos)) {\r\n                this.subPos = undefined;\r\n                this.speed = cc.Vec2.ZERO;\r\n                return;\r\n            }\r\n            this.moveOut = false;\r\n        }\r\n\r\n        this.moveEnd = touchPos;\r\n        this.updateTriggerBall();\r\n    }\r\n\r\n    /**\r\n     * 选中后移动\r\n     * @param dt 时间\r\n     */\r\n    public move(dt: number) {\r\n        if (this._slect && this.subPos != undefined) {\r\n            let pos = this.subPos.add(this.node.position);\r\n            let speed = this.moveEnd.sub(pos);\r\n            speed.mulSelf(1 / dt);\r\n            this.speed = speed;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置球的数字,第一次设置的时候设置大小\r\n     * @param num 球的数字\r\n     */\r\n    public setNum(num: number) {\r\n        //16为疯狂小五\r\n        if (num == 16) {\r\n            this.crazyBall = true;\r\n            num = 5;\r\n        }\r\n\r\n        if (num > 10) {\r\n            Ball.bigThanTenNum++;\r\n            cc.PhysicsManager.POSITION_ITERATIONS = 50;\r\n            this.addDoubleClick();\r\n        }\r\n\r\n        if (this.ballNum != undefined)\r\n            return;\r\n        this.setSize(num);\r\n        this.ballNum = num;\r\n    }\r\n\r\n    /**\r\n    * 设置眼睛打开还是关闭\r\n    * @param state 眼睛状态\r\n    */\r\n    public setEyeState(state: EyeState) {\r\n        if (this.eyeState == state)\r\n            return;\r\n        this.rigid.enabledContactListener = false;\r\n        this.eyeState = state;\r\n        let spriteFrame = this.eyeSpriteFrameArr[state];\r\n        for (let i = 0; i < this.eyeSpriteArr.length; i++) {\r\n            this.eyeSpriteArr[i].spriteFrame = spriteFrame;\r\n        }\r\n\r\n        //游戏结束,去掉所有监听\r\n        if (state == EyeState.die) {\r\n            this.node.targetOff(this);\r\n\r\n            //停止双击检测\r\n            this.hold_one_click = 0;\r\n        }\r\n    }\r\n\r\n    /** 恢复原始状态 */\r\n    public resume() {\r\n        this.isResume = true;\r\n        this.setSlect = false;\r\n        this.setTrigger = false;\r\n        this.node.stopAllActions();\r\n        this.setEyeState(EyeState.open);\r\n        this.node.opacity = 255;\r\n        this.node.active = false;\r\n        this.rigid.active = true;\r\n        this.hold_one_click = 0;\r\n        this.unscheduleAllCallbacks();\r\n        this.rigid.enabledContactListener = true;\r\n\r\n        //重置回收状态\r\n        this.isResume = false;\r\n\r\n        //大球直接删除\r\n        if (this.ballNum > 10) {\r\n            Ball.bigThanTenNum--;\r\n            if (Ball.bigThanTenNum == 0) {\r\n                cc.PhysicsManager.POSITION_ITERATIONS = 20;\r\n            }\r\n            this.node.removeFromParent(true);\r\n            return;\r\n        }\r\n        //游戏结束,停止了所有监听,重新监听\r\n        if (!this.node.hasEventListener(cc.Node.EventType.TOUCH_START))\r\n            this.addEventListener();\r\n    }\r\n\r\n    /**\r\n     * 监听点击事件\r\n     */\r\n    private addEventListener() {\r\n        this.node.on(cc.Node.EventType.TOUCH_START, (e) => {\r\n            //缩放状态不检测选中\r\n            if (this.node.scale != 1)\r\n                return;\r\n\r\n            this.onTouchStart(e);\r\n        }, this)\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, () => {\r\n            this.setSlect = false;\r\n            this.hold_one_click = 0;\r\n        }, this)\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_END, () => {\r\n            //点击结束触发了触发球,应该不触发双击(0.5有可能触发合并有触发双击)\r\n            if (GameCtrl.instance.triggerBall != undefined)\r\n                this.hold_one_click = 0;\r\n\r\n            this.setSlect = false;\r\n\r\n            //缩放状态不检测双击\r\n            if (this.node.scale != 1)\r\n                return;\r\n\r\n            //不检测双击\r\n            if (this.crazyBall)\r\n                return;\r\n            this.hold_one_click++;\r\n\r\n            //点击0.5秒后清0\r\n            let callback = () => {\r\n                this.hold_one_click = 0;\r\n            }\r\n            this.scheduleOnce(callback, 0.5);\r\n\r\n            //判断双击\r\n            if (this.hold_one_click > 1 && this.ballNum != 1)\r\n                GameCtrl.instance.ballsCtr.ballDoubleClick(this);\r\n        }, this)\r\n    }\r\n\r\n    /**\r\n     * 设置速度\r\n     */\r\n    public set speed(v: cc.Vec2) {\r\n        this.rigid.linearVelocity = v;\r\n    }\r\n\r\n    /**\r\n     * 延迟设置速度\r\n     * @param v 速度\r\n     * @param delayTime 延迟时间 \r\n     */\r\n    public speedDelay(v: cc.Vec2, delayTime: number = 0) {\r\n        let callback = () => {\r\n            this.speed = v;\r\n        }\r\n        this.scheduleOnce(callback, delayTime);\r\n    }\r\n\r\n    /**\r\n     * 获取速度\r\n     */\r\n    public get speed() {\r\n        return this.rigid.linearVelocity;\r\n    }\r\n\r\n    /**\r\n     * 判断点是否在球的范围内\r\n     * @param pos 判断点\r\n     */\r\n    private judgePosOut(pos: cc.Vec2): boolean {\r\n        let arr = this.colliderPoints;\r\n        if (arr.length > 0) {\r\n            let flag = cc.Intersection.pointInPolygon(pos, arr);\r\n            if (!flag) {\r\n                return true;\r\n            }\r\n        }\r\n        if (pos.mag() > this.nodeSize.x / 2) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 设置点击选中,可以移动\r\n     */\r\n    private set setSlect(enabled: boolean) {\r\n        if (this._slect == enabled)\r\n            return;\r\n        this._slect = enabled;\r\n        if (enabled) {\r\n            this.rigid.gravityScale = 0;\r\n            this.rigid.linearVelocity = cc.Vec2.ZERO;\r\n            this.ballNode.opacity = 127;\r\n            this.group = \"touch\";\r\n            GameCtrl.instance.slectBall = this;\r\n            GameCtrl.instance.triggerBall = undefined;\r\n            this.setEyeState(EyeState.close);\r\n            this.collider.tag = ColliderType.Slect;\r\n        } else {\r\n            this.rigid.enabledContactListener = true;\r\n            this.subPos = undefined;\r\n            this.rigid.gravityScale = 1;\r\n            this.rigid.linearVelocity = new cc.Vec2(0, 1);\r\n            this.group = \"ball\";\r\n            this.ballNode.opacity = 255;\r\n\r\n            //没有被回收,才触发touch\r\n            if (!this.isResume)\r\n                GameCtrl.instance.ballsCtr.touchEnd();\r\n            GameCtrl.instance.slectBall = undefined;\r\n            this.setEyeState(EyeState.open);\r\n        }\r\n        this.setIndex(enabled);\r\n        this.collider.apply();\r\n    }\r\n\r\n    /**\r\n     * 设置层级\r\n     * @param slect 是否选中\r\n     */\r\n    private setIndex(slect: boolean) {\r\n        this.node.zIndex = slect ? 1 : 0;\r\n    }\r\n\r\n    /**\r\n     * 设置球的状态,选中时不能旋转,可以碰撞的物体变动\r\n     */\r\n    private set group(str: string) {\r\n        this.node.group = str;\r\n        this.rigid.fixedRotation = str == \"touch\";\r\n    }\r\n\r\n    /**\r\n     * 根据数字,根据配置设置球大小信息\r\n     * @param num 球的数字\r\n     */\r\n    private setSize(num: number) {\r\n        let scal = ballScale[num - 1];\r\n        let size = ballsize[num - 1].clone();\r\n        size.x *= scal;\r\n        size.y *= scal;\r\n        this.nodeSize = size;\r\n        this.ballNode.scale = scal;\r\n        this.group = \"ball\";\r\n        let width = ballHighLightWidth;\r\n        this.setBottom();\r\n        let collider = undefined;\r\n        if (num < 10 || num == 15 || num == 16) {\r\n            collider = this.node.getComponent(cc.PhysicsCircleCollider);\r\n\r\n            //碰撞体的边缘离球是高亮的一半\r\n            collider.radius = size.x / 2 + width / 2;\r\n        } else if (num < 15) {\r\n            collider = this.node.getComponent(cc.PhysicsPolygonCollider);\r\n            this.colliderPoints = collider.points;\r\n            this.adjustPolygonColliderPoint(scal);\r\n            collider.points = this.colliderPoints;\r\n        }\r\n        collider.apply();\r\n    }\r\n\r\n    /** 设置底部高亮 */\r\n    private setBottom() {\r\n        /** 边距是上下 左右所以是两倍 */\r\n        let width = ballHighLightWidth * 2;\r\n        this.bottomNode.setContentSize(this.nodeSize.x + width, this.nodeSize.y + width);\r\n        this.bottomNode.opacity = 0;\r\n        this.bottomNode.color = new cc.Color(255, 249, 205);\r\n    }\r\n\r\n    /**\r\n     * 调整不规则球的碰撞边缘点\r\n     * @param scal 配置的缩放\r\n     */\r\n    private adjustPolygonColliderPoint(scal: number) {\r\n        let width = ballHighLightWidth;\r\n        let size = this.nodeSize.clone();\r\n        //球的原始大小\r\n        size.mulSelf(1 / scal);\r\n\r\n        //设计的尺寸加上高亮的一半\r\n        let change = (this.nodeSize.x + width) / size.x;\r\n        let length = this.colliderPoints.length;\r\n        for (let i = 0; i < length; i++)\r\n            this.colliderPoints[i] = this.colliderPoints[i].mulSelf(change);\r\n    }\r\n\r\n    /**\r\n     * 掉落时眨眼动画,30会帧率 4 5为隔了几帧\r\n     */\r\n    private blink() {\r\n        this.collider.tag = ColliderType.Normal;\r\n        this.node.runAction(\r\n            cc.sequence(\r\n                cc.callFunc(() => {\r\n                    if (this.eyeState != EyeState.die)\r\n                        this.setEyeState(EyeState.close);\r\n                }),\r\n                cc.delayTime(5 / 30),\r\n                cc.callFunc(() => {\r\n                    if (this.eyeState != EyeState.die)\r\n                        this.setEyeState(EyeState.open);\r\n                })\r\n            )\r\n        )\r\n    }\r\n\r\n    /**\r\n     * 点击触摸处理\r\n     * @param touch 点击事件\r\n     */\r\n    private onTouchStart(touch: cc.Event.EventTouch) {\r\n        if (GameCtrl.instance.slectBall != undefined)\r\n            return;\r\n        let pos = this.node.convertToNodeSpaceAR(touch.getLocation());\r\n        if (!this.judgePosOut(pos)) {\r\n            this.setSlect = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 移动选中球后,判断触发球是否改变\r\n     */\r\n    private updateTriggerBall() {\r\n\r\n        //大球暂时不检测触发\r\n        if (this.ballNum > 10) {\r\n            GameCtrl.instance.triggerBall = undefined;\r\n            return;\r\n        }\r\n\r\n        let speed = this.rigid.linearVelocity;\r\n\r\n        //双击bug,当速度太低,视为无效拖动\r\n        if (speed.mag() < 10)\r\n            return;\r\n        let ball = this.getTriggerBall();\r\n        let triggerBall = GameCtrl.instance.triggerBall;\r\n        if (triggerBall) {\r\n            if (triggerBall == ball)\r\n                return;\r\n        }\r\n        GameCtrl.instance.triggerBall = ball;\r\n    }\r\n\r\n    /**\r\n     * 获取选中球中心触发的球\r\n     */\r\n    private getTriggerBall(): Ball {\r\n        //节点销毁\r\n        if (this.node == undefined)\r\n            return undefined;\r\n\r\n        let ballArr = GameCtrl.instance.getGamePanelBall();\r\n\r\n        //如果是引导下触发的球只有一个\r\n        if (GameCtrl.instance.guide) {\r\n            ballArr = GameCtrl.instance.guide.ballOperate;\r\n\r\n            //引导模式下,移动球也需要是触发球\r\n            if (ballArr.indexOf(this) == -1)\r\n                return undefined;\r\n        }\r\n        let length = ballArr.length;\r\n\r\n        //手指位置获取的理论球位置\r\n        let ballForFinger = this.moveEnd.sub(this.subPos);\r\n\r\n        //遍历界面上的所有球判断有没有触发的\r\n        for (let i = 0; i < length; i++) {\r\n            let ball = ballArr[i];\r\n\r\n            //为自己,判断球为undefined或者判断球节点销毁\r\n            if (this == ball || ball == undefined || ball.node == undefined)\r\n                continue;\r\n\r\n            //手指获取理论球位置\r\n            let subPosForfinger = ballForFinger.sub(ball.node.position);\r\n            let flagForfinger = ball.judgePosOut(subPosForfinger);\r\n\r\n            //实际球位置判断\r\n            let subPos = this.node.position.sub(ball.node.position);\r\n            let flag = ball.judgePosOut(subPos);\r\n\r\n            //两个判断有一个生效,就默认触发\r\n            if (!flagForfinger || !flag)\r\n                return ball;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * 判断是否眨眼\r\n     */\r\n    private judegeBlink() {\r\n        if (GameCtrl.instance.slectBall == this)\r\n            return;\r\n        if (this.collider.tag == ColliderType.Birth || this.collider.tag == ColliderType.Slect)\r\n            this.blink();\r\n    }\r\n\r\n    /**\r\n     * 大于11 添加双击特效\r\n     */\r\n    private addDoubleClick() {\r\n        let node = cc.instantiate(GameCtrl.instance.balldoubleClick);\r\n        node.parent = this.node;\r\n        node.position = cc.Vec2.ZERO;\r\n        node.scale = 1;\r\n    }\r\n}"]}